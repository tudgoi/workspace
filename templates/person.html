{% extends "entity.html" %}
{% block toolbar %}
  {{ super() }}
  <a href="{{person.id}}/edit">Edit</a>
{% endblock toolbar %}

{% block content %}
<style>
  main {
    display: grid;
    column-gap: 1em;
    row-gap: 0.5em;
    grid-template-areas:
      "toolbar"
      "title"
      "photo"
      "offices"
      "contacts"
      "subordinates"
      "past-tenures"
      "sources";
    margin-bottom: 1em;
  }

  @media (min-width: 40em) {
    main {
      grid-template-columns: 1fr 3fr;
      grid-template-rows: min-content min-content min-content 1fr auto auto;
      grid-template-areas:
        "toolbar toolbar"
        "photo title"
        "photo offices"
        "photo contacts"
        "subordinates subordinates"
        "past-tenures past-tenures"
        "sources sources";
    }
  }
</style>
<main>
  <div class="photo">
    {% if photo %}
    {{ macros::render_photo(photo=photo, alt=person.name) }}
    {% elif offices and (offices | length > 0) and offices[0].photo %}
    {{ macros::render_photo(photo=offices[0].photo, alt=person.name) }}
    {% else %}
    {{ macros::render_photo(photo=config.defaults.photo, alt=person.name) }}
    {% endif %}
  </div>
  <div class="title">
    <h2>
      {{ person.name }}
      {{ macros::render_ext_links(links=contacts) }}
    </h2>
    <hr />
  </div>
  <div class="offices">
    {% if offices %}
    <dl class="office-list">
      {% for office in offices %}
      <dt>
        {{ macros::render_office(id=office.office.id, name=office.office.name) }}
        {{ macros::render_ext_links(links=office.contacts) }}
      </dt>
      <dd>
        {% if office.contacts %}
        {{ macros::render_contacts(contacts=office.contacts) }}
        {% endif %}
        {% if office.supervisors %}
        {{ macros::render_supervisors(officers=office.supervisors) }}
        {% endif %}
        {% endfor %}
    </dl>
    {% endif %}
  </div>
  <div class="contacts">
    {% if contacts %}
    <hr />
    {{ macros::render_contacts(contacts=contacts) }}
    {% endif %}
  </div>
  <div class="subordinates">
    {% if offices %}
    <hr />
    <dl>
      {% for office in offices %}
      {% if office.subordinates %}
      <dt>{{ office.office.name }}</dt>
      <dd>
        {{ macros::render_subordinates(officers=office.subordinates) }}
      </dd>
      {% endif %}
      {% endfor %}
    </dl>
    {% endif %}
  </div>

  <div class="past-tenures">
    {% if past_tenures %}
    <hr />
    <dl>
      <dt>Past Tenures</dt>
      <dd>
        <ul>
          {% for tenure in past_tenures %}
          <li>{{ macros::render_office(id=tenure.office.id, name=tenure.office.name) }}, <em>{{ tenure.start }} to {{
              tenure.end }}</em></li>
          {% endfor %}
        </ul>
      </dd>
    </dl>
    {% endif %}
  </div>
  <div class="sources">
    {% if page.extra.sources %}
    <hr>
    <details>
      <summary>Sources</summary>
      <ul>
        {% for url in page.extra.sources %}
        <li><a href="{{ url }}">{{ url }}</a></li>
        {% endfor %}
      </ul>
    </details>
    {% endif %}
  </div>
</main>
{% endblock content %}
