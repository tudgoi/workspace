{% extends "base.html" %}
{% import "macros.html" as macros %}
{% block content %}
<style>
  div.toolbar {
    grid-area: toolbar;
  }

  div.photo {
    grid-area: photo;
  }

  div.title {
    grid-area: title;
  }

  div.offices {
    grid-area: offices;
  }

  div.contacts {
    grid-area: contacts;
  }

  div.past-tenures {
    grid-area: past-tenures;
  }

  div.subordinates {
    grid-area: subordinates;
  }

  div.sources {
    grid-area: sources;
  }

  main {
    display: grid;
    column-gap: 1em;
    row-gap: 0.5em;
    grid-template-areas:
      "toolbar"
      "title"
      "photo"
      "offices"
      "contacts"
      "subordinates"
      "past-tenures"
      "sources";
    margin-bottom: 1em;
  }

  @media (min-width: 40em) {
    main {
      grid-template-columns: 1fr 3fr;
      grid-template-rows: min-content min-content min-content 1fr auto auto;
      grid-template-areas:
        "toolbar toolbar"
        "photo title"
        "photo offices"
        "photo contacts"
        "subordinates subordinates"
        "past-tenures past-tenures"
        "sources sources";
    }
  }

  .dl-single-line {
    display: grid;
    grid-template-columns: auto 1fr;
    column-gap: 0.5em;
  }

  .photo {
    display: grid;
    grid-template-columns: 1fr;
  }

  .photo figure img {
    width: 12em;
    margin: 0em;
    border: 10px solid lightgray;
  }

  .photo figure figcaption {
    width: 20em;
    padding-inline: 1em;
    font-size: x-small;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  dl.contact-list {
    display: grid;
    grid-template-columns: 1fr 1fr;
  }

  dl.office-list dt {
    margin-bottom: 0.3em;
  }

  span.ext-links {
    margin-left: 1em;
  }

  .icon svg {
    width: 1em;
    height: 1em;
    vertical-align: -0.15em;
  }

  button .icon svg path {
    fill: white;
  }

  @media (prefers-color-scheme: dark) {
    .icon svg path {
      fill: white;
    }
  }

  div.toolbar {
    text-align: right;
    font-size: small
  }
</style>
<main>
  <div class="toolbar">
    {% if page.dynamic %}
    <a href="edit/{{person.id}}">Edit</a>
    {% endif %}
  </div>
  <div class="photo">
    {% if photo %}
    {{ macros::render_photo(photo=photo, alt=person.name) }}
    {% elif offices and (offices | length > 0) and offices[0].photo %}
    {{ macros::render_photo(photo=offices[0].photo, alt=person.name) }}
    {% else %}
    {{ macros::render_photo(photo=config.defaults.photo, alt=person.name) }}
    {% endif %}
  </div>
  <div class="title">
    <h2>
      {{ person.name }}
      {{ macros::render_ext_links(links=contacts) }}
    </h2>
    <hr />
  </div>
  <div class="offices">
    {% if offices %}
    <dl class="office-list">
      {% for office in offices %}
      <dt>
        {{ macros::render_office(id=office.office.id, name=office.office.name) }}
        {{ macros::render_ext_links(links=office.contacts) }}
      </dt>
      <dd>
        {% if office.contacts %}
        {{ macros::render_contacts(contacts=office.contacts) }}
        {% endif %}
        {% if office.supervisors %}
        {{ macros::render_supervisors(officers=office.supervisors) }}
        {% endif %}
        {% endfor %}
    </dl>
    {% endif %}
  </div>
  <div class="contacts">
    {% if contacts %}
    <hr />
    {{ macros::render_contacts(contacts=contacts) }}
    {% endif %}
  </div>
  <div class="subordinates">
    {% if offices %}
    <hr />
    <dl>
      {% for office in offices %}
      {% if office.subordinates %}
      <dt>{{ office.office.name }}</dt>
      <dd>
        {{ macros::render_subordinates(officers=office.subordinates) }}
      </dd>
      {% endif %}
      {% endfor %}
    </dl>
    {% endif %}
  </div>

  <div class="past-tenures">
    {% if past_tenures %}
    <hr />
    <dl>
      <dt>Past Tenures</dt>
      <dd>
        <ul>
          {% for tenure in past_tenures %}
          <li>{{ macros::render_office(id=tenure.office.id, name=tenure.office.name) }}, <em>{{ tenure.start }} to {{
              tenure.end }}</em></li>
          {% endfor %}
        </ul>
      </dd>
    </dl>
    {% endif %}
  </div>
  <div class="sources">
    {% if page.extra.sources %}
    <hr>
    <details>
      <summary>Sources</summary>
      <ul>
        {% for url in page.extra.sources %}
        <li><a href="{{ url }}">{{ url }}</a></li>
        {% endfor %}
      </ul>
    </details>
    {% endif %}
  </div>
</main>
{% endblock content %}

{% block updated %}
{% if metadata.updated %}
Last updated on {{ metadata.commit_date | date(format="%d %B, %Y")}}
{% else %}
Local version
{% endif %}
{% endblock updated %}